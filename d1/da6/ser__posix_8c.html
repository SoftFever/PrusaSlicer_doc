<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Prusa Slicer: src/avrdude/ser_posix.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../PrusaSlicer_32px.png"/></td>
  <td id="projectalign">
   <div id="projectname">Prusa Slicer<span id="projectnumber">&#160;2.6.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d1/da6/ser__posix_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ser_posix.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;sys/ioctl.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;netdb.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;termios.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../">unistd.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../">avrdude.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">libavrdude.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">ac_cfg.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for ser_posix.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d2/d29/ser__posix_8c__incl.svg" width="100%" height="493"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:d5/ddd/structbaud__mapping"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#d5/ddd/structbaud__mapping">baud_mapping</a></td></tr>
<tr class="separator:d5/ddd/structbaud__mapping"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8ebc9c75f568a8e33ca434c2868aed8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a8ebc9c75f568a8e33ca434c2868aed8e">MAX_ZERO_READS</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:a8ebc9c75f568a8e33ca434c2868aed8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb870b81e746f2472932e829d9831a54"><td class="memItemLeft" align="right" valign="top">static speed_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#abb870b81e746f2472932e829d9831a54">serial_baud_lookup</a> (<a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a> baud)</td></tr>
<tr class="separator:abb870b81e746f2472932e829d9831a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a488a68da785cd69549206a350f667320"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a488a68da785cd69549206a350f667320">ser_setspeed</a> (union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fd, <a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a> baud)</td></tr>
<tr class="separator:a488a68da785cd69549206a350f667320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa62286a5564a8378cb1c78a901cb9e3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d6f/unistd_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#aa62286a5564a8378cb1c78a901cb9e3a">read_timeout</a> (int fd, <a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> *buf, size_t count, <a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a> timeout)</td></tr>
<tr class="separator:aa62286a5564a8378cb1c78a901cb9e3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0807aa52f717534113eef539421b6a1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d6f/unistd_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a0807aa52f717534113eef539421b6a1a">write_timeout</a> (int fd, <a class="el" href="../../dc/d53/getopt_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> *buf, size_t count, <a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a> timeout)</td></tr>
<tr class="separator:a0807aa52f717534113eef539421b6a1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24e8bbc7d2161643e27471d148f8b60"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#ad24e8bbc7d2161643e27471d148f8b60">net_open</a> (<a class="el" href="../../dc/d53/getopt_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *port, union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fdp)</td></tr>
<tr class="separator:ad24e8bbc7d2161643e27471d148f8b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae10a941a4bcbd6bd749be19c11b5e2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a8ae10a941a4bcbd6bd749be19c11b5e2">ser_set_dtr_rts</a> (union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fdp, int is_on)</td></tr>
<tr class="separator:a8ae10a941a4bcbd6bd749be19c11b5e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fcb1d9729cf897c15eece92745f7db2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a2fcb1d9729cf897c15eece92745f7db2">ser_open</a> (char *port, union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d34/unionpinfo">pinfo</a> <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d34/unionpinfo">pinfo</a>, union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fdp)</td></tr>
<tr class="separator:a2fcb1d9729cf897c15eece92745f7db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc01dbb5b9102e529bb8a973f41fb592"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#acc01dbb5b9102e529bb8a973f41fb592">ser_close</a> (union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fd)</td></tr>
<tr class="separator:acc01dbb5b9102e529bb8a973f41fb592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f1493e12150b568a0c1f12e022e65d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#af0f1493e12150b568a0c1f12e022e65d">ser_send</a> (union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fd, <a class="el" href="../../dc/d53/getopt_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> unsigned char *buf, size_t buflen)</td></tr>
<tr class="separator:af0f1493e12150b568a0c1f12e022e65d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e8a2d8b0b8535c808851383a0b1788"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#af9e8a2d8b0b8535c808851383a0b1788">ser_recv</a> (union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fd, unsigned char *buf, size_t buflen)</td></tr>
<tr class="separator:af9e8a2d8b0b8535c808851383a0b1788"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd467ff311aa487c2dbfa9cf3d2a9ad8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#abd467ff311aa487c2dbfa9cf3d2a9ad8">ser_drain</a> (union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *fd, int display)</td></tr>
<tr class="separator:abd467ff311aa487c2dbfa9cf3d2a9ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a59b7fd323def148642bdf382f733a065"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a59b7fd323def148642bdf382f733a065">serial_recv_timeout</a> = 4000</td></tr>
<tr class="separator:a59b7fd323def148642bdf382f733a065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31d1c7a859808e39a35dbad8fa0cd05e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d1/da6/ser__posix_8c.html#d5/ddd/structbaud__mapping">baud_mapping</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a31d1c7a859808e39a35dbad8fa0cd05e">baud_lookup_table</a> []</td></tr>
<tr class="separator:a31d1c7a859808e39a35dbad8fa0cd05e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07853ed4a90cb9bb09bb00dd6a8c209c"><td class="memItemLeft" align="right" valign="top">static struct termios&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a07853ed4a90cb9bb09bb00dd6a8c209c">original_termios</a></td></tr>
<tr class="separator:a07853ed4a90cb9bb09bb00dd6a8c209c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2893c07fea78e2b020e1567fe011fa4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#ac2893c07fea78e2b020e1567fe011fa4">saved_original_termios</a></td></tr>
<tr class="separator:ac2893c07fea78e2b020e1567fe011fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b2c98085e7cd22a5fc5a19e26c82a2"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/d00/structserial__device.html">serial_device</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#ae0b2c98085e7cd22a5fc5a19e26c82a2">serial_serdev</a></td></tr>
<tr class="separator:ae0b2c98085e7cd22a5fc5a19e26c82a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b2f1811fb510851fbcf51d489f68283"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/d00/structserial__device.html">serial_device</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da6/ser__posix_8c.html#a1b2f1811fb510851fbcf51d489f68283">serdev</a> = &amp;<a class="el" href="../../d2/d68/libavrdude_8h.html#ae0b2c98085e7cd22a5fc5a19e26c82a2">serial_serdev</a></td></tr>
<tr class="separator:a1b2f1811fb510851fbcf51d489f68283"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="d5/ddd/structbaud__mapping" id="d5/ddd/structbaud__mapping"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d5/ddd/structbaud__mapping">&#9670;&#160;</a></span>baud_mapping</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct baud_mapping</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"></div><table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="aec73b74c355318b827abb8b80608d936" name="aec73b74c355318b827abb8b80608d936"></a><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a></td>
<td class="fieldname">
baud</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a071b5ba24ea79af135b5bc5ee91b7107" name="a071b5ba24ea79af135b5bc5ee91b7107"></a>speed_t</td>
<td class="fieldname">
speed</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8ebc9c75f568a8e33ca434c2868aed8e" name="a8ebc9c75f568a8e33ca434c2868aed8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ebc9c75f568a8e33ca434c2868aed8e">&#9670;&#160;</a></span>MAX_ZERO_READS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ZERO_READS&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad24e8bbc7d2161643e27471d148f8b60" name="ad24e8bbc7d2161643e27471d148f8b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24e8bbc7d2161643e27471d148f8b60">&#9670;&#160;</a></span>net_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int net_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d53/getopt_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fdp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  224</span>{</div>
<div class="line"><span class="lineno">  225</span><span class="preprocessor">#ifdef HAVE_GETADDRINFO</span></div>
<div class="line"><span class="lineno">  226</span>  <span class="keywordtype">char</span> *hp, *hstr, *pstr;</div>
<div class="line"><span class="lineno">  227</span>  <span class="keywordtype">int</span> s, fd, ret = -1;</div>
<div class="line"><span class="lineno">  228</span>  <span class="keyword">struct </span>addrinfo hints;</div>
<div class="line"><span class="lineno">  229</span>  <span class="keyword">struct </span>addrinfo *result, *rp;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>  <span class="keywordflow">if</span> ((hstr = hp = strdup(port)) == NULL) {</div>
<div class="line"><span class="lineno">  232</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: net_open(): Out of memory!\n&quot;</span>,</div>
<div class="line"><span class="lineno">  233</span>      <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  238</span><span class="comment">   * As numeric IPv6 addresses use colons as separators, we need to</span></div>
<div class="line"><span class="lineno">  239</span><span class="comment">   * look for the last colon here, which separates the port number or</span></div>
<div class="line"><span class="lineno">  240</span><span class="comment">   * service name from the host or IP address.</span></div>
<div class="line"><span class="lineno">  241</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  242</span>  <span class="keywordflow">if</span> (((pstr = strrchr(hstr, <span class="charliteral">&#39;:&#39;</span>)) == NULL) || (pstr == hstr)) {</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: net_open(): Mangled host:port string \&quot;%s\&quot;\n&quot;</span>,</div>
<div class="line"><span class="lineno">  244</span>      <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, hstr);</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../de/dca/tga_8cpp.html#adbb625a19574e9e39e1d07df31b00b06">error</a>;</div>
<div class="line"><span class="lineno">  246</span>  }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  249</span><span class="comment">   * Remove brackets from the host part, if present.</span></div>
<div class="line"><span class="lineno">  250</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  251</span>  <span class="keywordflow">if</span> (*hstr == <span class="charliteral">&#39;[&#39;</span> &amp;&amp; *(pstr-1) == <span class="charliteral">&#39;]&#39;</span>) {</div>
<div class="line"><span class="lineno">  252</span>    hstr++;</div>
<div class="line"><span class="lineno">  253</span>    *(pstr-1) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  254</span>  }</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">   * Terminate the host section of the description.</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  259</span>  *pstr++ = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>  memset(&amp;hints, 0, <span class="keyword">sizeof</span>(hints));</div>
<div class="line"><span class="lineno">  262</span>  hints.ai_family = AF_UNSPEC;</div>
<div class="line"><span class="lineno">  263</span>  hints.ai_socktype = SOCK_STREAM;</div>
<div class="line"><span class="lineno">  264</span>  s = getaddrinfo(hstr, pstr, &amp;hints, &amp;result);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>  <span class="keywordflow">if</span> (s != 0) {</div>
<div class="line"><span class="lineno">  267</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>,</div>
<div class="line"><span class="lineno">  268</span>      <span class="stringliteral">&quot;%s: net_open(): Cannot resolve &quot;</span></div>
<div class="line"><span class="lineno">  269</span>      <span class="stringliteral">&quot;host=\&quot;%s\&quot;, port=\&quot;%s\&quot;: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  270</span>      <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, hstr, pstr, gai_strerror(s));</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../de/dca/tga_8cpp.html#adbb625a19574e9e39e1d07df31b00b06">error</a>;</div>
<div class="line"><span class="lineno">  272</span>  }</div>
<div class="line"><span class="lineno">  273</span>  <span class="keywordflow">for</span> (rp = result; rp != NULL; rp = rp-&gt;ai_next) {</div>
<div class="line"><span class="lineno">  274</span>    fd = socket(rp-&gt;ai_family, rp-&gt;ai_socktype, rp-&gt;ai_protocol);</div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordflow">if</span> (fd == -1) {</div>
<div class="line"><span class="lineno">  276</span>      <span class="comment">/* This one failed, loop over */</span></div>
<div class="line"><span class="lineno">  277</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  278</span>    }</div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">if</span> (connect(fd, rp-&gt;ai_addr, rp-&gt;ai_addrlen) != -1) {</div>
<div class="line"><span class="lineno">  280</span>      <span class="comment">/* Success, we are connected */</span></div>
<div class="line"><span class="lineno">  281</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span>    close(fd);</div>
<div class="line"><span class="lineno">  284</span>  }</div>
<div class="line"><span class="lineno">  285</span>  <span class="keywordflow">if</span> (rp == NULL) {</div>
<div class="line"><span class="lineno">  286</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: net_open(): Cannot connect: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  287</span>      <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, strerror(errno));</div>
<div class="line"><span class="lineno">  288</span>  }</div>
<div class="line"><span class="lineno">  289</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  290</span>    fdp-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a> = fd;</div>
<div class="line"><span class="lineno">  291</span>    ret = 0;</div>
<div class="line"><span class="lineno">  292</span>  }</div>
<div class="line"><span class="lineno">  293</span>  freeaddrinfo(result);</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span><a class="code hl_variable" href="../../de/dca/tga_8cpp.html#adbb625a19574e9e39e1d07df31b00b06">error</a>:</div>
<div class="line"><span class="lineno">  296</span>  <a class="code hl_function" href="../../d3/dbc/config__gram_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(hp);</div>
<div class="line"><span class="lineno">  297</span>  <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  298</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  299</span>  <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>,</div>
<div class="line"><span class="lineno">  300</span>    <span class="stringliteral">&quot;%s: Networking is not supported on your platform.\n&quot;</span></div>
<div class="line"><span class="lineno">  301</span>    <span class="stringliteral">&quot;If you need it, please open a bug report.\n&quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  302</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  303</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_GETADDRINFO */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  304</span>}</div>
<div class="ttc" id="aavrdude_8h_html_a1ddcc97224a95cec04b38b0ac866fa19"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a></div><div class="ttdeci">#define MSG_INFO</div><div class="ttdef"><b>Definition</b> avrdude.h:51</div></div>
<div class="ttc" id="aavrdude_8h_html_ab9e1449fd00c98428516f0b41eddcb10"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a></div><div class="ttdeci">char * progname</div><div class="ttdef"><b>Definition</b> main.c:61</div></div>
<div class="ttc" id="aavrdude_8h_html_ae3011b9c6440c863e64eed3fed5106e3"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a></div><div class="ttdeci">int avrdude_message(const int msglvl, const char *format,...)</div><div class="ttdef"><b>Definition</b> main.c:93</div></div>
<div class="ttc" id="aconfig__gram_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../d3/dbc/config__gram_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="alibavrdude_8h_html_af67a8aabc0107825a78baeac91bfbfb1"><div class="ttname"><a href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">filedescriptor::ifd</a></div><div class="ttdeci">int ifd</div><div class="ttdef"><b>Definition</b> libavrdude.h:522</div></div>
<div class="ttc" id="atga_8cpp_html_adbb625a19574e9e39e1d07df31b00b06"><div class="ttname"><a href="../../de/dca/tga_8cpp.html#adbb625a19574e9e39e1d07df31b00b06">error</a></div><div class="ttdeci">static char error[256]</div><div class="ttdef"><b>Definition</b> tga.cpp:50</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00050">error</a>, <a class="el" href="../../d3/dbc/config__gram_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, and <a class="el" href="../../#l00061">progname</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../#l00336">ser_open()</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_ad24e8bbc7d2161643e27471d148f8b60_cgraph.svg" width="260" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_ad24e8bbc7d2161643e27471d148f8b60_icgraph.svg" width="208" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa62286a5564a8378cb1c78a901cb9e3a" name="aa62286a5564a8378cb1c78a901cb9e3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa62286a5564a8378cb1c78a901cb9e3a">&#9670;&#160;</a></span>read_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d6f/unistd_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> read_timeout </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a>&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">struct </span>timeval tm, tm2;</div>
<div class="line"><span class="lineno">  160</span>  fd_set rfds;</div>
<div class="line"><span class="lineno">  161</span>  <span class="keywordtype">int</span> nfds;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  tm.tv_sec  = timeout / 1000L;</div>
<div class="line"><span class="lineno">  164</span>  tm.tv_usec = (timeout % 1000L) * 1000;</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  167</span>    FD_ZERO(&amp;rfds);</div>
<div class="line"><span class="lineno">  168</span>    FD_SET(fd, &amp;rfds);</div>
<div class="line"><span class="lineno">  169</span>    tm2 = tm;</div>
<div class="line"><span class="lineno">  170</span>    nfds = select(fd + 1, &amp;rfds, NULL, NULL, &amp;tm2);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">if</span> (nfds == 0) {</div>
<div class="line"><span class="lineno">  173</span>      <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  174</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nfds == -1) {</div>
<div class="line"><span class="lineno">  175</span>      <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN) {</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  177</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  179</span>      }</div>
<div class="line"><span class="lineno">  180</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  181</span>      <span class="keywordflow">return</span> read(fd, buf, count);</div>
<div class="line"><span class="lineno">  182</span>    }</div>
<div class="line"><span class="lineno">  183</span>  }</div>
<div class="line"><span class="lineno">  184</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../#l00509">ser_drain()</a>, and <a class="el" href="../../#l00451">ser_recv()</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_aa62286a5564a8378cb1c78a901cb9e3a_icgraph.svg" width="230" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acc01dbb5b9102e529bb8a973f41fb592" name="acc01dbb5b9102e529bb8a973f41fb592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc01dbb5b9102e529bb8a973f41fb592">&#9670;&#160;</a></span>ser_close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> ser_close </td>
          <td>(</td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  376</span>{</div>
<div class="line"><span class="lineno">  377</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  378</span><span class="comment">   * restore original termios settings from ser_open</span></div>
<div class="line"><span class="lineno">  379</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  380</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#ac2893c07fea78e2b020e1567fe011fa4">saved_original_termios</a>) {</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordtype">int</span> rc = tcsetattr(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, TCSANOW | TCSADRAIN, &amp;<a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#a07853ed4a90cb9bb09bb00dd6a8c209c">original_termios</a>);</div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">if</span> (rc) {</div>
<div class="line"><span class="lineno">  383</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_close(): can&#39;t reset attributes for device: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  384</span>                      <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, strerror(errno));</div>
<div class="line"><span class="lineno">  385</span>    }</div>
<div class="line"><span class="lineno">  386</span>    <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#ac2893c07fea78e2b020e1567fe011fa4">saved_original_termios</a> = 0;</div>
<div class="line"><span class="lineno">  387</span>  }</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>  close(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>);</div>
<div class="line"><span class="lineno">  390</span>}</div>
<div class="ttc" id="aser__posix_8c_html_a07853ed4a90cb9bb09bb00dd6a8c209c"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a07853ed4a90cb9bb09bb00dd6a8c209c">original_termios</a></div><div class="ttdeci">static struct termios original_termios</div><div class="ttdef"><b>Definition</b> ser_posix.c:76</div></div>
<div class="ttc" id="aser__posix_8c_html_ac2893c07fea78e2b020e1567fe011fa4"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#ac2893c07fea78e2b020e1567fe011fa4">saved_original_termios</a></div><div class="ttdeci">static int saved_original_termios</div><div class="ttdef"><b>Definition</b> ser_posix.c:77</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, <a class="el" href="../../#l00076">original_termios</a>, <a class="el" href="../../#l00061">progname</a>, and <a class="el" href="../../#l00077">saved_original_termios</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_acc01dbb5b9102e529bb8a973f41fb592_cgraph.svg" width="264" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abd467ff311aa487c2dbfa9cf3d2a9ad8" name="abd467ff311aa487c2dbfa9cf3d2a9ad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd467ff311aa487c2dbfa9cf3d2a9ad8">&#9670;&#160;</a></span>ser_drain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ser_drain </td>
          <td>(</td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>display</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  510</span>{</div>
<div class="line"><span class="lineno">  511</span>  <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  512</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf;</div>
<div class="line"><span class="lineno">  513</span>  <span class="keywordtype">unsigned</span> zero_reads = 0;</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordflow">if</span> (display) {</div>
<div class="line"><span class="lineno">  516</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;drain&gt;&quot;</span>);</div>
<div class="line"><span class="lineno">  517</span>  }</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_define" href="../../d2/d68/libavrdude_8h.html#acd1b780d66a6f95e53d8139eb7979355">RETURN_IF_CANCEL</a>();</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    rc = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#aa62286a5564a8378cb1c78a901cb9e3a">read_timeout</a>(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, &amp;buf, 1, 250);   <span class="comment">// Note: timeout needs to be kept low to not timeout in programmers</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> (rc == -2) {</div>
<div class="line"><span class="lineno">  524</span>      <span class="keywordflow">if</span> (display) {</div>
<div class="line"><span class="lineno">  525</span>        <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;&lt;drain\n&quot;</span>);</div>
<div class="line"><span class="lineno">  526</span>      }</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  529</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><span class="lineno">  530</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_drain(): read error: %s\n&quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, strerror(errno));</div>
<div class="line"><span class="lineno">  531</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  532</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><span class="lineno">  533</span>      zero_reads++;</div>
<div class="line"><span class="lineno">  534</span>      <span class="keywordflow">if</span> (zero_reads &gt; <a class="code hl_define" href="../../d1/da6/ser__posix_8c.html#a8ebc9c75f568a8e33ca434c2868aed8e">MAX_ZERO_READS</a>) {</div>
<div class="line"><span class="lineno">  535</span>        <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#ae5a11e7738886ec5eb0ddecdf4b358ec">MSG_NOTICE2</a>, <span class="stringliteral">&quot;%s: ser_drain(): programmer is not responding (too many zero reads)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  536</span>                <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  538</span>      }</div>
<div class="line"><span class="lineno">  539</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  540</span>      zero_reads = 0;</div>
<div class="line"><span class="lineno">  541</span>    }</div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">if</span> (display) {</div>
<div class="line"><span class="lineno">  543</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%02x &quot;</span>, buf);</div>
<div class="line"><span class="lineno">  544</span>    }</div>
<div class="line"><span class="lineno">  545</span>  }</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  548</span>}</div>
<div class="ttc" id="aavrdude_8h_html_ae5a11e7738886ec5eb0ddecdf4b358ec"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#ae5a11e7738886ec5eb0ddecdf4b358ec">MSG_NOTICE2</a></div><div class="ttdeci">#define MSG_NOTICE2</div><div class="ttdef"><b>Definition</b> avrdude.h:53</div></div>
<div class="ttc" id="alibavrdude_8h_html_acd1b780d66a6f95e53d8139eb7979355"><div class="ttname"><a href="../../d2/d68/libavrdude_8h.html#acd1b780d66a6f95e53d8139eb7979355">RETURN_IF_CANCEL</a></div><div class="ttdeci">#define RETURN_IF_CANCEL()</div><div class="ttdef"><b>Definition</b> libavrdude.h:733</div></div>
<div class="ttc" id="aser__posix_8c_html_a8ebc9c75f568a8e33ca434c2868aed8e"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a8ebc9c75f568a8e33ca434c2868aed8e">MAX_ZERO_READS</a></div><div class="ttdeci">#define MAX_ZERO_READS</div><div class="ttdef"><b>Definition</b> ser_posix.c:48</div></div>
<div class="ttc" id="aser__posix_8c_html_aa62286a5564a8378cb1c78a901cb9e3a"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#aa62286a5564a8378cb1c78a901cb9e3a">read_timeout</a></div><div class="ttdeci">ssize_t read_timeout(int fd, void *buf, size_t count, long timeout)</div><div class="ttdef"><b>Definition</b> ser_posix.c:157</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00048">MAX_ZERO_READS</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, <a class="el" href="../../#l00053">MSG_NOTICE2</a>, <a class="el" href="../../#l00061">progname</a>, <a class="el" href="../../#l00157">read_timeout()</a>, and <a class="el" href="../../#l00733">RETURN_IF_CANCEL</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_abd467ff311aa487c2dbfa9cf3d2a9ad8_cgraph.svg" width="260" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2fcb1d9729cf897c15eece92745f7db2" name="a2fcb1d9729cf897c15eece92745f7db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fcb1d9729cf897c15eece92745f7db2">&#9670;&#160;</a></span>ser_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ser_open </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d34/unionpinfo">pinfo</a>&#160;</td>
          <td class="paramname"><em>pinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fdp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  337</span>{</div>
<div class="line"><span class="lineno">  338</span>  <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  339</span>  <span class="keywordtype">int</span> fd;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">   * If the port is of the form &quot;net:&lt;host&gt;:&lt;port&gt;&quot;, then</span></div>
<div class="line"><span class="lineno">  343</span><span class="comment">   * handle it as a TCP connection to a terminal server.</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  345</span>  <span class="keywordflow">if</span> (strncmp(port, <span class="stringliteral">&quot;net:&quot;</span>, strlen(<span class="stringliteral">&quot;net:&quot;</span>)) == 0) {</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#ad24e8bbc7d2161643e27471d148f8b60">net_open</a>(port + strlen(<span class="stringliteral">&quot;net:&quot;</span>), fdp);</div>
<div class="line"><span class="lineno">  347</span>  }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">   * open the serial port</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  352</span>  fd = open(port, O_RDWR | O_NOCTTY | O_NONBLOCK);</div>
<div class="line"><span class="lineno">  353</span>  <span class="keywordflow">if</span> (fd &lt; 0) {</div>
<div class="line"><span class="lineno">  354</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_open(): can&#39;t open device \&quot;%s\&quot;: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  355</span>            <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, port, strerror(errno));</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  357</span>  }</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>  fdp-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a> = fd;</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  362</span><span class="comment">   * set serial line attributes</span></div>
<div class="line"><span class="lineno">  363</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  364</span>  rc = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#a488a68da785cd69549206a350f667320">ser_setspeed</a>(fdp, <a class="code hl_union" href="../../d2/d68/libavrdude_8h.html#db/d34/unionpinfo">pinfo</a>.<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#ace7c0e41eddbd256a55d2ea9923b153f">baud</a>);</div>
<div class="line"><span class="lineno">  365</span>  <span class="keywordflow">if</span> (rc) {</div>
<div class="line"><span class="lineno">  366</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_open(): can&#39;t set attributes for device \&quot;%s\&quot;: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  367</span>                    <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, port, strerror(-rc));</div>
<div class="line"><span class="lineno">  368</span>    close(fd);</div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  370</span>  }</div>
<div class="line"><span class="lineno">  371</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  372</span>}</div>
<div class="ttc" id="alibavrdude_8h_html_ace7c0e41eddbd256a55d2ea9923b153f"><div class="ttname"><a href="../../d2/d68/libavrdude_8h.html#ace7c0e41eddbd256a55d2ea9923b153f">pinfo::baud</a></div><div class="ttdeci">long baud</div><div class="ttdef"><b>Definition</b> libavrdude.h:537</div></div>
<div class="ttc" id="alibavrdude_8h_html_db/d34/unionpinfo"><div class="ttname"><a href="../../d2/d68/libavrdude_8h.html#db/d34/unionpinfo">pinfo</a></div><div class="ttdef"><b>Definition</b> libavrdude.h:536</div></div>
<div class="ttc" id="aser__posix_8c_html_a488a68da785cd69549206a350f667320"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a488a68da785cd69549206a350f667320">ser_setspeed</a></div><div class="ttdeci">static int ser_setspeed(union filedescriptor *fd, long baud)</div><div class="ttdef"><b>Definition</b> ser_posix.c:99</div></div>
<div class="ttc" id="aser__posix_8c_html_ad24e8bbc7d2161643e27471d148f8b60"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#ad24e8bbc7d2161643e27471d148f8b60">net_open</a></div><div class="ttdeci">static int net_open(const char *port, union filedescriptor *fdp)</div><div class="ttdef"><b>Definition</b> ser_posix.c:223</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00537">pinfo::baud</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, <a class="el" href="../../#l00223">net_open()</a>, <a class="el" href="../../#l00061">progname</a>, and <a class="el" href="../../#l00099">ser_setspeed()</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_a2fcb1d9729cf897c15eece92745f7db2_cgraph.svg" width="588" height="179"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af9e8a2d8b0b8535c808851383a0b1788" name="af9e8a2d8b0b8535c808851383a0b1788"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9e8a2d8b0b8535c808851383a0b1788">&#9670;&#160;</a></span>ser_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ser_recv </td>
          <td>(</td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  452</span>{</div>
<div class="line"><span class="lineno">  453</span>  <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  454</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * p = buf;</div>
<div class="line"><span class="lineno">  455</span>  <span class="keywordtype">size_t</span> len = 0;</div>
<div class="line"><span class="lineno">  456</span>  <span class="keywordtype">unsigned</span> zero_reads = 0;</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>  <span class="keywordflow">while</span> (len &lt; buflen) {</div>
<div class="line"><span class="lineno">  459</span>    <a class="code hl_define" href="../../d2/d68/libavrdude_8h.html#acd1b780d66a6f95e53d8139eb7979355">RETURN_IF_CANCEL</a>();</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>    rc = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#aa62286a5564a8378cb1c78a901cb9e3a">read_timeout</a>(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, p, (buflen - len &gt; 1024) ? 1024 : buflen - len, <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#a59b7fd323def148642bdf382f733a065">serial_recv_timeout</a>);</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">if</span> (rc == -2) {</div>
<div class="line"><span class="lineno">  464</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#ae5a11e7738886ec5eb0ddecdf4b358ec">MSG_NOTICE2</a>, <span class="stringliteral">&quot;%s: ser_recv(): programmer is not responding\n&quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  465</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  466</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><span class="lineno">  467</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_recv(): read error: %s\n&quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, strerror(errno));</div>
<div class="line"><span class="lineno">  468</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  469</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><span class="lineno">  470</span>      zero_reads++;</div>
<div class="line"><span class="lineno">  471</span>      <span class="keywordflow">if</span> (zero_reads &gt; <a class="code hl_define" href="../../d1/da6/ser__posix_8c.html#a8ebc9c75f568a8e33ca434c2868aed8e">MAX_ZERO_READS</a>) {</div>
<div class="line"><span class="lineno">  472</span>        <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#ae5a11e7738886ec5eb0ddecdf4b358ec">MSG_NOTICE2</a>, <span class="stringliteral">&quot;%s: ser_recv(): programmer is not responding (too many zero reads)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  473</span>                <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  475</span>      }</div>
<div class="line"><span class="lineno">  476</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  477</span>      zero_reads = 0;</div>
<div class="line"><span class="lineno">  478</span>      p += rc;</div>
<div class="line"><span class="lineno">  479</span>      len += rc;</div>
<div class="line"><span class="lineno">  480</span>    }</div>
<div class="line"><span class="lineno">  481</span>  }</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>  p = buf;</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../db/daf/avrdude_8h.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt; 3)</div>
<div class="line"><span class="lineno">  486</span>  {</div>
<div class="line"><span class="lineno">  487</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;%s: Recv: &quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>      <span class="keywordflow">while</span> (len) {</div>
<div class="line"><span class="lineno">  490</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a4a8a08f09d37b73795649038408b5f33">c</a> = *p;</div>
<div class="line"><span class="lineno">  491</span>        <span class="keywordflow">if</span> (isprint(c)) {</div>
<div class="line"><span class="lineno">  492</span>          <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;%c &quot;</span>, c);</div>
<div class="line"><span class="lineno">  493</span>        }</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  495</span>          <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;. &quot;</span>);</div>
<div class="line"><span class="lineno">  496</span>        }</div>
<div class="line"><span class="lineno">  497</span>        <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;[%02x] &quot;</span>, c);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>        p++;</div>
<div class="line"><span class="lineno">  500</span>        len--;</div>
<div class="line"><span class="lineno">  501</span>      }</div>
<div class="line"><span class="lineno">  502</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  503</span>  }</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  506</span>}</div>
<div class="ttc" id="aavrdude_8h_html_a0b2caeb4b6f130be43e5a2f0267dd453"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdef"><b>Definition</b> main.c:198</div></div>
<div class="ttc" id="aavrdude_8h_html_a2db9e0f667fa6b3c881b3350cd2bb8a6"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a></div><div class="ttdeci">#define MSG_TRACE</div><div class="ttdef"><b>Definition</b> avrdude.h:55</div></div>
<div class="ttc" id="anamespacemarchsq_1_1____impl_html_a5c3960032271d7907677d3507c909780a4a8a08f09d37b73795649038408b5f33"><div class="ttname"><a href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a4a8a08f09d37b73795649038408b5f33">marchsq::__impl::SquareTag::c</a></div><div class="ttdeci">@ c</div></div>
<div class="ttc" id="aser__posix_8c_html_a59b7fd323def148642bdf382f733a065"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a59b7fd323def148642bdf382f733a065">serial_recv_timeout</a></div><div class="ttdeci">long serial_recv_timeout</div><div class="ttdef"><b>Definition</b> ser_posix.c:47</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00048">MAX_ZERO_READS</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, <a class="el" href="../../#l00053">MSG_NOTICE2</a>, <a class="el" href="../../#l00055">MSG_TRACE</a>, <a class="el" href="../../#l00061">progname</a>, <a class="el" href="../../#l00157">read_timeout()</a>, <a class="el" href="../../#l00733">RETURN_IF_CANCEL</a>, <a class="el" href="../../#l00047">serial_recv_timeout</a>, and <a class="el" href="../../#l00198">verbose</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_af9e8a2d8b0b8535c808851383a0b1788_cgraph.svg" width="258" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af0f1493e12150b568a0c1f12e022e65d" name="af0f1493e12150b568a0c1f12e022e65d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0f1493e12150b568a0c1f12e022e65d">&#9670;&#160;</a></span>ser_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ser_send </td>
          <td>(</td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d53/getopt_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  394</span>{</div>
<div class="line"><span class="lineno">  395</span>  <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  396</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * p = buf;</div>
<div class="line"><span class="lineno">  397</span>  <span class="keywordtype">size_t</span> len = buflen;</div>
<div class="line"><span class="lineno">  398</span>  <span class="keywordtype">unsigned</span> zero_writes = 0;</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordflow">if</span> (!len)</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../db/daf/avrdude_8h.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt; 3)</div>
<div class="line"><span class="lineno">  404</span>  {</div>
<div class="line"><span class="lineno">  405</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;%s: Send: &quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>      <span class="keywordflow">while</span> (buflen) {</div>
<div class="line"><span class="lineno">  408</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a4a8a08f09d37b73795649038408b5f33">c</a> = *buf;</div>
<div class="line"><span class="lineno">  409</span>        <span class="keywordflow">if</span> (isprint(c)) {</div>
<div class="line"><span class="lineno">  410</span>          <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;%c &quot;</span>, c);</div>
<div class="line"><span class="lineno">  411</span>        }</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  413</span>          <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;. &quot;</span>);</div>
<div class="line"><span class="lineno">  414</span>        }</div>
<div class="line"><span class="lineno">  415</span>        <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;[%02x] &quot;</span>, c);</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        buf++;</div>
<div class="line"><span class="lineno">  418</span>        buflen--;</div>
<div class="line"><span class="lineno">  419</span>      }</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a2db9e0f667fa6b3c881b3350cd2bb8a6">MSG_TRACE</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  422</span>  }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>  <span class="keywordflow">while</span> (len) {</div>
<div class="line"><span class="lineno">  425</span>    <a class="code hl_define" href="../../d2/d68/libavrdude_8h.html#acd1b780d66a6f95e53d8139eb7979355">RETURN_IF_CANCEL</a>();</div>
<div class="line"><span class="lineno">  426</span>    rc = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#a0807aa52f717534113eef539421b6a1a">write_timeout</a>(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, p, (len &gt; 1024) ? 1024 : len, <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#a59b7fd323def148642bdf382f733a065">serial_recv_timeout</a>);</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordflow">if</span> (rc == -2) {</div>
<div class="line"><span class="lineno">  428</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#ae5a11e7738886ec5eb0ddecdf4b358ec">MSG_NOTICE2</a>, <span class="stringliteral">&quot;%s: ser_send(): programmer is not responding\n&quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  429</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  430</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><span class="lineno">  431</span>      <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_send(): write error: %s\n&quot;</span>, <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, strerror(errno));</div>
<div class="line"><span class="lineno">  432</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  433</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><span class="lineno">  434</span>      zero_writes++;</div>
<div class="line"><span class="lineno">  435</span>      <span class="keywordflow">if</span> (zero_writes &gt; <a class="code hl_define" href="../../d1/da6/ser__posix_8c.html#a8ebc9c75f568a8e33ca434c2868aed8e">MAX_ZERO_READS</a>) {</div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#ae5a11e7738886ec5eb0ddecdf4b358ec">MSG_NOTICE2</a>, <span class="stringliteral">&quot;%s: ser_send(): programmer is not responding (too many zero writes)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  437</span>                <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  439</span>      }</div>
<div class="line"><span class="lineno">  440</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  441</span>      zero_writes = 0;</div>
<div class="line"><span class="lineno">  442</span>      p += rc;</div>
<div class="line"><span class="lineno">  443</span>      len -= rc;</div>
<div class="line"><span class="lineno">  444</span>    }</div>
<div class="line"><span class="lineno">  445</span>  }</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  448</span>}</div>
<div class="ttc" id="aser__posix_8c_html_a0807aa52f717534113eef539421b6a1a"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a0807aa52f717534113eef539421b6a1a">write_timeout</a></div><div class="ttdeci">ssize_t write_timeout(int fd, const void *buf, size_t count, long timeout)</div><div class="ttdef"><b>Definition</b> ser_posix.c:186</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00048">MAX_ZERO_READS</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, <a class="el" href="../../#l00053">MSG_NOTICE2</a>, <a class="el" href="../../#l00055">MSG_TRACE</a>, <a class="el" href="../../#l00061">progname</a>, <a class="el" href="../../#l00733">RETURN_IF_CANCEL</a>, <a class="el" href="../../#l00047">serial_recv_timeout</a>, <a class="el" href="../../#l00198">verbose</a>, and <a class="el" href="../../#l00186">write_timeout()</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_af0f1493e12150b568a0c1f12e022e65d_cgraph.svg" width="260" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8ae10a941a4bcbd6bd749be19c11b5e2" name="a8ae10a941a4bcbd6bd749be19c11b5e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ae10a941a4bcbd6bd749be19c11b5e2">&#9670;&#160;</a></span>ser_set_dtr_rts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ser_set_dtr_rts </td>
          <td>(</td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_on</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  308</span>{</div>
<div class="line"><span class="lineno">  309</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  ctl;</div>
<div class="line"><span class="lineno">  310</span>  <span class="keywordtype">int</span>           r;</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>  r = ioctl(fdp-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, TIOCMGET, &amp;ctl);</div>
<div class="line"><span class="lineno">  313</span>  <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line"><span class="lineno">  314</span>    perror(<span class="stringliteral">&quot;ioctl(\&quot;TIOCMGET\&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  316</span>  }</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>  <span class="keywordflow">if</span> (is_on) {</div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">/* Set DTR and RTS */</span></div>
<div class="line"><span class="lineno">  320</span>    ctl |= (TIOCM_DTR | TIOCM_RTS);</div>
<div class="line"><span class="lineno">  321</span>  }</div>
<div class="line"><span class="lineno">  322</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  323</span>    <span class="comment">/* Clear DTR and RTS */</span></div>
<div class="line"><span class="lineno">  324</span>    ctl &amp;= ~(TIOCM_DTR | TIOCM_RTS);</div>
<div class="line"><span class="lineno">  325</span>  }</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  r = ioctl(fdp-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, TIOCMSET, &amp;ctl);</div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line"><span class="lineno">  329</span>    perror(<span class="stringliteral">&quot;ioctl(\&quot;TIOCMSET\&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  331</span>  }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  334</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00522">filedescriptor::ifd</a>.</p>

</div>
</div>
<a id="a488a68da785cd69549206a350f667320" name="a488a68da785cd69549206a350f667320"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a488a68da785cd69549206a350f667320">&#9670;&#160;</a></span>ser_setspeed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ser_setspeed </td>
          <td>(</td>
          <td class="paramtype">union <a class="el" href="../../d2/d68/libavrdude_8h.html#db/d26/unionfiledescriptor">filedescriptor</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a>&#160;</td>
          <td class="paramname"><em>baud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  100</span>{</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keyword">struct </span>termios termios;</div>
<div class="line"><span class="lineno">  103</span>  speed_t speed = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#abb870b81e746f2472932e829d9831a54">serial_baud_lookup</a> (baud);</div>
<div class="line"><span class="lineno">  104</span>  </div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d6f/unistd_8h.html#aef88e7abfad3a0a8812ec4a04ea1de6b">isatty</a>(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>))</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">return</span> -ENOTTY;</div>
<div class="line"><span class="lineno">  107</span>  </div>
<div class="line"><span class="lineno">  108</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  109</span><span class="comment">   * initialize terminal modes</span></div>
<div class="line"><span class="lineno">  110</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  111</span>  rc = tcgetattr(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, &amp;termios);</div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><span class="lineno">  113</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_setspeed(): tcgetattr() failed\n&quot;</span>,</div>
<div class="line"><span class="lineno">  114</span>            <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordflow">return</span> -errno;</div>
<div class="line"><span class="lineno">  116</span>  }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  119</span><span class="comment">   * copy termios for ser_close if we haven&#39;t already</span></div>
<div class="line"><span class="lineno">  120</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">if</span> (! <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#ac2893c07fea78e2b020e1567fe011fa4">saved_original_termios</a>++) {</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#a07853ed4a90cb9bb09bb00dd6a8c209c">original_termios</a> = termios;</div>
<div class="line"><span class="lineno">  123</span>  }</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  termios.c_iflag = IGNBRK;</div>
<div class="line"><span class="lineno">  126</span>  termios.c_oflag = 0;</div>
<div class="line"><span class="lineno">  127</span>  termios.c_lflag = 0;</div>
<div class="line"><span class="lineno">  128</span>  termios.c_cflag = (CS8 | CREAD | CLOCAL);</div>
<div class="line"><span class="lineno">  129</span>  termios.c_cc[VMIN]  = 1;</div>
<div class="line"><span class="lineno">  130</span>  termios.c_cc[VTIME] = 0;</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  cfsetospeed(&amp;termios, speed);</div>
<div class="line"><span class="lineno">  133</span>  cfsetispeed(&amp;termios, speed);</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  rc = tcsetattr(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, TCSANOW, &amp;termios);</div>
<div class="line"><span class="lineno">  136</span>  <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><span class="lineno">  137</span>    <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#a1ddcc97224a95cec04b38b0ac866fa19">MSG_INFO</a>, <span class="stringliteral">&quot;%s: ser_setspeed(): tcsetattr() failed\n&quot;</span>,</div>
<div class="line"><span class="lineno">  138</span>            <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>);</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">return</span> -errno;</div>
<div class="line"><span class="lineno">  140</span>  }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  143</span><span class="comment">   * Everything is now set up for a local line without modem control</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">   * or flow control, so clear O_NONBLOCK again.</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  146</span>  rc = fcntl(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, F_GETFL, 0);</div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordflow">if</span> (rc != -1)</div>
<div class="line"><span class="lineno">  148</span>    fcntl(fd-&gt;<a class="code hl_variable" href="../../d2/d68/libavrdude_8h.html#af67a8aabc0107825a78baeac91bfbfb1">ifd</a>, F_SETFL, rc &amp; ~O_NONBLOCK);</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  151</span>}</div>
<div class="ttc" id="aser__posix_8c_html_abb870b81e746f2472932e829d9831a54"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#abb870b81e746f2472932e829d9831a54">serial_baud_lookup</a></div><div class="ttdeci">static speed_t serial_baud_lookup(long baud)</div><div class="ttdef"><b>Definition</b> ser_posix.c:79</div></div>
<div class="ttc" id="aunistd_8h_html_aef88e7abfad3a0a8812ec4a04ea1de6b"><div class="ttname"><a href="../../da/d6f/unistd_8h.html#aef88e7abfad3a0a8812ec4a04ea1de6b">isatty</a></div><div class="ttdeci">#define isatty</div><div class="ttdef"><b>Definition</b> unistd.h:46</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00522">filedescriptor::ifd</a>, <a class="el" href="../../#l00046">isatty</a>, <a class="el" href="../../#l00051">MSG_INFO</a>, <a class="el" href="../../#l00076">original_termios</a>, <a class="el" href="../../#l00061">progname</a>, <a class="el" href="../../#l00077">saved_original_termios</a>, and <a class="el" href="../../#l00079">serial_baud_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../#l00336">ser_open()</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_a488a68da785cd69549206a350f667320_cgraph.svg" width="466" height="62"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_a488a68da785cd69549206a350f667320_icgraph.svg" width="232" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abb870b81e746f2472932e829d9831a54" name="abb870b81e746f2472932e829d9831a54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb870b81e746f2472932e829d9831a54">&#9670;&#160;</a></span>serial_baud_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static speed_t serial_baud_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a>&#160;</td>
          <td class="paramname"><em>baud</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   80</span>{</div>
<div class="line"><span class="lineno">   81</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/da6/ser__posix_8c.html#d5/ddd/structbaud__mapping">baud_mapping</a> *map = <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#a31d1c7a859808e39a35dbad8fa0cd05e">baud_lookup_table</a>;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">while</span> (map-&gt;<a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#aec73b74c355318b827abb8b80608d936">baud</a>) {</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">if</span> (map-&gt;<a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#aec73b74c355318b827abb8b80608d936">baud</a> == <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#aec73b74c355318b827abb8b80608d936">baud</a>)</div>
<div class="line"><span class="lineno">   85</span>      <span class="keywordflow">return</span> map-&gt;<a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#a071b5ba24ea79af135b5bc5ee91b7107">speed</a>;</div>
<div class="line"><span class="lineno">   86</span>    map++;</div>
<div class="line"><span class="lineno">   87</span>  }</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   90</span><span class="comment">   * If a non-standard BAUD rate is used, issue</span></div>
<div class="line"><span class="lineno">   91</span><span class="comment">   * a warning (if we are verbose) and return the raw rate</span></div>
<div class="line"><span class="lineno">   92</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">   93</span>  <a class="code hl_function" href="../../db/daf/avrdude_8h.html#ae3011b9c6440c863e64eed3fed5106e3">avrdude_message</a>(<a class="code hl_define" href="../../db/daf/avrdude_8h.html#ad4a8684ff0e683a17328f48469ea6deb">MSG_NOTICE</a>, <span class="stringliteral">&quot;%s: serial_baud_lookup(): Using non-standard baud rate: %ld\n&quot;</span>,</div>
<div class="line"><span class="lineno">   94</span>              <a class="code hl_variable" href="../../db/daf/avrdude_8h.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#aec73b74c355318b827abb8b80608d936">baud</a>);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d1/da6/ser__posix_8c.html#aec73b74c355318b827abb8b80608d936">baud</a>;</div>
<div class="line"><span class="lineno">   97</span>}</div>
<div class="ttc" id="aavrdude_8h_html_ad4a8684ff0e683a17328f48469ea6deb"><div class="ttname"><a href="../../db/daf/avrdude_8h.html#ad4a8684ff0e683a17328f48469ea6deb">MSG_NOTICE</a></div><div class="ttdeci">#define MSG_NOTICE</div><div class="ttdef"><b>Definition</b> avrdude.h:52</div></div>
<div class="ttc" id="aser__posix_8c_html_a071b5ba24ea79af135b5bc5ee91b7107"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a071b5ba24ea79af135b5bc5ee91b7107">baud_mapping::speed</a></div><div class="ttdeci">speed_t speed</div><div class="ttdef"><b>Definition</b> ser_posix.c:52</div></div>
<div class="ttc" id="aser__posix_8c_html_a31d1c7a859808e39a35dbad8fa0cd05e"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a31d1c7a859808e39a35dbad8fa0cd05e">baud_lookup_table</a></div><div class="ttdeci">static struct baud_mapping baud_lookup_table[]</div><div class="ttdef"><b>Definition</b> ser_posix.c:57</div></div>
<div class="ttc" id="aser__posix_8c_html_aec73b74c355318b827abb8b80608d936"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#aec73b74c355318b827abb8b80608d936">baud_mapping::baud</a></div><div class="ttdeci">long baud</div><div class="ttdef"><b>Definition</b> ser_posix.c:51</div></div>
<div class="ttc" id="aser__posix_8c_html_d5/ddd/structbaud__mapping"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#d5/ddd/structbaud__mapping">baud_mapping</a></div><div class="ttdef"><b>Definition</b> ser_posix.c:50</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00093">avrdude_message()</a>, <a class="el" href="../../#l00051">baud_mapping::baud</a>, <a class="el" href="../../#l00057">baud_lookup_table</a>, <a class="el" href="../../#l00052">MSG_NOTICE</a>, <a class="el" href="../../#l00061">progname</a>, and <a class="el" href="../../#l00052">baud_mapping::speed</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../#l00099">ser_setspeed()</a>.</p>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_abb870b81e746f2472932e829d9831a54_cgraph.svg" width="319" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_abb870b81e746f2472932e829d9831a54_icgraph.svg" width="414" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0807aa52f717534113eef539421b6a1a" name="a0807aa52f717534113eef539421b6a1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0807aa52f717534113eef539421b6a1a">&#9670;&#160;</a></span>write_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d6f/unistd_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> write_timeout </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d53/getopt_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a>&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  187</span>{</div>
<div class="line"><span class="lineno">  188</span>  <span class="keyword">struct </span>timeval tm, tm2;</div>
<div class="line"><span class="lineno">  189</span>  fd_set wfds;</div>
<div class="line"><span class="lineno">  190</span>  <span class="keywordtype">int</span> nfds;</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  tm.tv_sec  = timeout / 1000L;</div>
<div class="line"><span class="lineno">  193</span>  tm.tv_usec = (timeout % 1000L) * 1000;</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  196</span>    FD_ZERO(&amp;wfds);</div>
<div class="line"><span class="lineno">  197</span>    FD_SET(fd, &amp;wfds);</div>
<div class="line"><span class="lineno">  198</span>    tm2 = tm;</div>
<div class="line"><span class="lineno">  199</span>    nfds = select(fd + 1, NULL, &amp;wfds, NULL, &amp;tm2);</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span> (nfds == 0) {</div>
<div class="line"><span class="lineno">  202</span>      <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  203</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nfds == -1) {</div>
<div class="line"><span class="lineno">  204</span>      <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN) {</div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  206</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  208</span>      }</div>
<div class="line"><span class="lineno">  209</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  210</span>      <span class="keywordflow">return</span> write(fd, buf, count);</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>  }</div>
<div class="line"><span class="lineno">  213</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../#l00393">ser_send()</a>.</p>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/da6/ser__posix_8c_a0807aa52f717534113eef539421b6a1a_icgraph.svg" width="232" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a31d1c7a859808e39a35dbad8fa0cd05e" name="a31d1c7a859808e39a35dbad8fa0cd05e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31d1c7a859808e39a35dbad8fa0cd05e">&#9670;&#160;</a></span>baud_lookup_table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/da6/ser__posix_8c.html#d5/ddd/structbaud__mapping">baud_mapping</a> baud_lookup_table[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">  { 1200,   B1200 },</div>
<div class="line">  { 2400,   B2400 },</div>
<div class="line">  { 4800,   B4800 },</div>
<div class="line">  { 9600,   B9600 },</div>
<div class="line">  { 19200,  B19200 },</div>
<div class="line">  { 38400,  B38400 },</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  { 0,      0 }                 </div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../#l00079">serial_baud_lookup()</a>.</p>

</div>
</div>
<a id="a07853ed4a90cb9bb09bb00dd6a8c209c" name="a07853ed4a90cb9bb09bb00dd6a8c209c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07853ed4a90cb9bb09bb00dd6a8c209c">&#9670;&#160;</a></span>original_termios</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct termios original_termios</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00375">ser_close()</a>, and <a class="el" href="../../#l00099">ser_setspeed()</a>.</p>

</div>
</div>
<a id="ac2893c07fea78e2b020e1567fe011fa4" name="ac2893c07fea78e2b020e1567fe011fa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2893c07fea78e2b020e1567fe011fa4">&#9670;&#160;</a></span>saved_original_termios</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int saved_original_termios</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00375">ser_close()</a>, and <a class="el" href="../../#l00099">ser_setspeed()</a>.</p>

</div>
</div>
<a id="a1b2f1811fb510851fbcf51d489f68283" name="a1b2f1811fb510851fbcf51d489f68283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b2f1811fb510851fbcf51d489f68283">&#9670;&#160;</a></span>serdev</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/d00/structserial__device.html">serial_device</a>* serdev = &amp;<a class="el" href="../../d2/d68/libavrdude_8h.html#ae0b2c98085e7cd22a5fc5a19e26c82a2">serial_serdev</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l01311">jtag3_open_common()</a>, <a class="el" href="../../#l00680">jtagmkI_close()</a>, <a class="el" href="../../#l00532">jtagmkI_initialize()</a>, <a class="el" href="../../#l01647">jtagmkII_dragon_open()</a>, <a class="el" href="../../#l01702">jtagmkII_dragon_open_dw()</a>, <a class="el" href="../../#l01757">jtagmkII_dragon_open_pdi()</a>, <a class="el" href="../../#l01276">jtagmkII_initialize()</a>, <a class="el" href="../../#l01484">jtagmkII_open()</a>, <a class="el" href="../../#l03334">jtagmkII_open32()</a>, <a class="el" href="../../#l01538">jtagmkII_open_dw()</a>, <a class="el" href="../../#l01592">jtagmkII_open_pdi()</a>, <a class="el" href="../../#l01639">stk500v2_open()</a>, and <a class="el" href="../../#l01709">stk600_open()</a>.</p>

</div>
</div>
<a id="a59b7fd323def148642bdf382f733a065" name="a59b7fd323def148642bdf382f733a065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b7fd323def148642bdf382f733a065">&#9670;&#160;</a></span>serial_recv_timeout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d34/windows_8hpp.html#abc8f9f29715ddba51ee7f197feb6fd26">long</a> serial_recv_timeout = 4000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00773">buspirate_disable()</a>, <a class="el" href="../../#l00293">buspirate_parseextparms()</a>, <a class="el" href="../../#l00175">buspirate_readline_noexit()</a>, <a class="el" href="../../#l01622">jtag3_paged_load()</a>, <a class="el" href="../../#l01518">jtag3_paged_write()</a>, <a class="el" href="../../#l00847">jtagmkI_paged_load()</a>, <a class="el" href="../../#l00713">jtagmkI_paged_write()</a>, <a class="el" href="../../#l00246">jtagmkI_resync()</a>, <a class="el" href="../../#l01880">jtagmkII_page_erase()</a>, <a class="el" href="../../#l02110">jtagmkII_paged_load()</a>, <a class="el" href="../../#l03472">jtagmkII_paged_load32()</a>, <a class="el" href="../../#l01975">jtagmkII_paged_write()</a>, <a class="el" href="../../#l03560">jtagmkII_paged_write32()</a>, <a class="el" href="../../#l03237">jtagmkII_read_SABaddr()</a>, <a class="el" href="../../#l00451">ser_recv()</a>, and <a class="el" href="../../#l00393">ser_send()</a>.</p>

</div>
</div>
<a id="ae0b2c98085e7cd22a5fc5a19e26c82a2" name="ae0b2c98085e7cd22a5fc5a19e26c82a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0b2c98085e7cd22a5fc5a19e26c82a2">&#9670;&#160;</a></span>serial_serdev</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/d00/structserial__device.html">serial_device</a> serial_serdev</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">{</div>
<div class="line">  .open = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#a2fcb1d9729cf897c15eece92745f7db2">ser_open</a>,</div>
<div class="line">  .setspeed = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#a488a68da785cd69549206a350f667320">ser_setspeed</a>,</div>
<div class="line">  .close = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#acc01dbb5b9102e529bb8a973f41fb592">ser_close</a>,</div>
<div class="line">  .send = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#af0f1493e12150b568a0c1f12e022e65d">ser_send</a>,</div>
<div class="line">  .recv = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#af9e8a2d8b0b8535c808851383a0b1788">ser_recv</a>,</div>
<div class="line">  .drain = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#abd467ff311aa487c2dbfa9cf3d2a9ad8">ser_drain</a>,</div>
<div class="line">  .set_dtr_rts = <a class="code hl_function" href="../../d1/da6/ser__posix_8c.html#a8ae10a941a4bcbd6bd749be19c11b5e2">ser_set_dtr_rts</a>,</div>
<div class="line">  .flags = <a class="code hl_define" href="../../d2/d68/libavrdude_8h.html#ae658af2ddd5a48d5a9e84ec748e8683a">SERDEV_FL_CANSETSPEED</a>,</div>
<div class="line">}</div>
<div class="ttc" id="alibavrdude_8h_html_ae658af2ddd5a48d5a9e84ec748e8683a"><div class="ttname"><a href="../../d2/d68/libavrdude_8h.html#ae658af2ddd5a48d5a9e84ec748e8683a">SERDEV_FL_CANSETSPEED</a></div><div class="ttdeci">#define SERDEV_FL_CANSETSPEED</div><div class="ttdef"><b>Definition</b> libavrdude.h:564</div></div>
<div class="ttc" id="aser__posix_8c_html_a2fcb1d9729cf897c15eece92745f7db2"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a2fcb1d9729cf897c15eece92745f7db2">ser_open</a></div><div class="ttdeci">static int ser_open(char *port, union pinfo pinfo, union filedescriptor *fdp)</div><div class="ttdef"><b>Definition</b> ser_posix.c:336</div></div>
<div class="ttc" id="aser__posix_8c_html_a8ae10a941a4bcbd6bd749be19c11b5e2"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#a8ae10a941a4bcbd6bd749be19c11b5e2">ser_set_dtr_rts</a></div><div class="ttdeci">static int ser_set_dtr_rts(union filedescriptor *fdp, int is_on)</div><div class="ttdef"><b>Definition</b> ser_posix.c:307</div></div>
<div class="ttc" id="aser__posix_8c_html_abd467ff311aa487c2dbfa9cf3d2a9ad8"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#abd467ff311aa487c2dbfa9cf3d2a9ad8">ser_drain</a></div><div class="ttdeci">static int ser_drain(union filedescriptor *fd, int display)</div><div class="ttdef"><b>Definition</b> ser_posix.c:509</div></div>
<div class="ttc" id="aser__posix_8c_html_acc01dbb5b9102e529bb8a973f41fb592"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#acc01dbb5b9102e529bb8a973f41fb592">ser_close</a></div><div class="ttdeci">static void ser_close(union filedescriptor *fd)</div><div class="ttdef"><b>Definition</b> ser_posix.c:375</div></div>
<div class="ttc" id="aser__posix_8c_html_af0f1493e12150b568a0c1f12e022e65d"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#af0f1493e12150b568a0c1f12e022e65d">ser_send</a></div><div class="ttdeci">static int ser_send(union filedescriptor *fd, const unsigned char *buf, size_t buflen)</div><div class="ttdef"><b>Definition</b> ser_posix.c:393</div></div>
<div class="ttc" id="aser__posix_8c_html_af9e8a2d8b0b8535c808851383a0b1788"><div class="ttname"><a href="../../d1/da6/ser__posix_8c.html#af9e8a2d8b0b8535c808851383a0b1788">ser_recv</a></div><div class="ttdeci">static int ser_recv(union filedescriptor *fd, unsigned char *buf, size_t buflen)</div><div class="ttdef"><b>Definition</b> ser_posix.c:451</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_3152723ac38ccb2051caa7ee1212accf.html">avrdude</a></li><li class="navelem"><a class="el" href="../../d1/da6/ser__posix_8c.html">ser_posix.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
